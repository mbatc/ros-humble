diff --git a/test_wasm/CMakeLists.txt b/test_wasm/CMakeLists.txt
index c6c95b9..17bec43 100644
--- a/test_wasm/CMakeLists.txt
+++ b/test_wasm/CMakeLists.txt
@@ -10,10 +10,15 @@ find_package(ament_cmake REQUIRED)
 find_package(rclcpp REQUIRED)
 find_package(std_msgs REQUIRED)
 find_package(example_interfaces REQUIRED)
+find_package(PkgConfig REQUIRED)
+
+pkg_check_modules(yaml REQUIRED yaml-0.1)
 
 # Targets and link
 include(cmake/WasmBuildOptions.cmake)
 
+link_directories(${yaml_LIBRARY_DIRS})
+
 add_executable(talker src/test_publisher.cpp)
 ament_target_dependencies(talker rclcpp std_msgs)
 
@@ -26,6 +31,11 @@ ament_target_dependencies(server rclcpp example_interfaces)
 add_executable(client src/test_service_client.cpp)
 ament_target_dependencies(client rclcpp example_interfaces)
 
+target_compile_options(talker PUBLIC -fPIC)
+target_compile_options(listener PUBLIC -fPIC)
+target_compile_options(server PUBLIC -fPIC)
+target_compile_options(client PUBLIC -fPIC)
+
 add_compile_options("SHELL:-s USE_PTHREADS")
 
 add_link_options("SHELL:-s USE_PTHREADS")
